{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/zhoux/Desktop/community-job-app/frontend/pages/publish/publish.vue?048e","webpack:///C:/Users/zhoux/Desktop/community-job-app/frontend/pages/publish/publish.vue?08a2","webpack:///C:/Users/zhoux/Desktop/community-job-app/frontend/pages/publish/publish.vue?e0d7","webpack:///C:/Users/zhoux/Desktop/community-job-app/frontend/pages/publish/publish.vue?03a5","uni-app:///pages/publish/publish.vue","webpack:///C:/Users/zhoux/Desktop/community-job-app/frontend/pages/publish/publish.vue?43da","webpack:///C:/Users/zhoux/Desktop/community-job-app/frontend/pages/publish/publish.vue?416c"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","name","setup","category","description","price","unit","schedule","location","contact","contactPhone","images","requireEscrow","label","value","form","uni","count","success","submitting","title","icon","jobId","takerId","publisherId","amount","escrowed","url","method","data","setTimeout","fail","complete","city","tags","contactName","routeOptions","categories","units","categoryLabel","selectCategory","selectUnit","chooseImage","submit","onEscrowChange","isApplyMode"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,gBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgI;AAChI;AAC2D;AACL;AACsC;;;AAG5F;AAC0L;AAC1L,gBAAgB,2LAAU;AAC1B,EAAE,6EAAM;AACR,EAAE,8FAAM;AACR,EAAE,uGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,kGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAutB,CAAgB,urBAAG,EAAC,C;;;;;;;;;;;;;;;;;;AC8E3uB;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAEA;EACAC;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;IAEA,kBACA;MAAAC;MAAAC;IAAA,GACA;MAAAD;MAAAC;IAAA,GACA;MAAAD;MAAAC;IAAA,GACA;MAAAD;MAAAC;IAAA,GACA;MAAAD;MAAAC;IAAA,GACA;MAAAD;MAAAC;IAAA,EACA;IAEA;IACA;IACA;MAAA;IAAA;IACA;MAAA;IAAA;IACA;MAAA;IAAA;IACA;IAEA;MAAA,OACAC;IAAA,EACA;IAEA;MACA;MACAA;IACA;IAEA;MACA;MACAA;IACA;IAEA;MACAC;QACAC;QACAC;UACA;UACAH;QACA;MACA;IACA;IAEA;MACAA;IACA;IAEA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IAEA;MACA;QACA;MACA;MACAI;MAEA;QACA;UACAH;YAAAI;YAAAC;UAAA;UACAF;UACA;QACA;QACA;UACAG;UACAC;UACAC;UACAC;UACAC;QACA;QACAV;UACAW;UACAC;UACAC;UACAX;YACAF;cAAAI;cAAAC;YAAA;YACAS;cACAd;gBAAAW;cAAA;YACA;UACA;UACAI;YACAf;cAAAI;cAAAC;YAAA;UACA;UACAW;YACAb;UACA;QACA;QACA;MACA;MAEA;MACA;QACAH;UAAAI;UAAAC;QAAA;QACAF;QACA;MACA;MAEA;QACAC;QACAhB;QACAD;QACAE;QACAC;QACAC;QACAC;QACAyB;QACAC;QACAvB;QACAC;QACAY;QACAW;QACAzB;MACA;MAEAM;QACAW;QACAC;QACAC;QACAX;UACAF;YAAAI;YAAAC;UAAA;UACAS;YACAd;cAAAW;YAAA;UACA;QACA;QACAI;UACAf;YAAAI;YAAAC;UAAA;QACA;QACAW;UACAb;QACA;MACA;IACA;IAEA;MACAiB;IACA;IAEA;MACArB;MACAsB;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACzPA;AAAA;AAAA;AAAA;AAAs3C,CAAgB,svCAAG,EAAC,C;;;;;;;;;;;ACA14C;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/publish/publish.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/publish/publish.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./publish.vue?vue&type=template&id=177a8126&scoped=true&\"\nvar renderjs\nimport script from \"./publish.vue?vue&type=script&lang=js&\"\nexport * from \"./publish.vue?vue&type=script&lang=js&\"\nimport style0 from \"./publish.vue?vue&type=style&index=0&id=177a8126&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"177a8126\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/publish/publish.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./publish.vue?vue&type=template&id=177a8126&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./publish.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./publish.vue?vue&type=script&lang=js&\"","<template>\n  <scroll-view class=\"publish\" scroll-y>\n    <view class=\"page-padding\">\n      <view class=\"publish__section\">\n        <view class=\"section-title\">{{ isApplyMode ? '报名任务' : '发布任务' }}</view>\n        <picker :range=\"categories\" range-key=\"label\" @change=\"selectCategory\">\n          <view class=\"publish__input\">\n            <text>{{ categoryLabel }}</text>\n            <text class=\"publish__icon\">⌄</text>\n          </view>\n        </picker>\n        <textarea\n          class=\"publish__textarea\"\n          v-model=\"form.description\"\n          placeholder=\"描述任务内容、时间、需求人群、要求及注意事项\"\n          maxlength=\"500\"\n          auto-height\n        />\n        <view class=\"publish__group\">\n          <view class=\"publish__group-item\">\n            <text class=\"publish__label\">预算/价格</text>\n            <input type=\"number\" v-model.number=\"form.price\" placeholder=\"请输入金额\" />\n          </view>\n          <view class=\"publish__group-item\">\n            <text class=\"publish__label\">计费单位</text>\n            <picker mode=\"selector\" :range=\"units\" @change=\"selectUnit\">\n              <text>{{ form.unit || '次' }}</text>\n            </picker>\n          </view>\n        </view>\n        <view class=\"publish__field\">\n          <text class=\"publish__label\">时间安排</text>\n          <input v-model=\"form.schedule\" placeholder=\"例如：每周二、四 16:30\" />\n        </view>\n        <view class=\"publish__field\">\n          <text class=\"publish__label\">服务地址</text>\n          <input v-model=\"form.location\" placeholder=\"请输入服务地址\" />\n        </view>\n        <view class=\"publish__field\">\n          <text class=\"publish__label\">联系人</text>\n          <input v-model=\"form.contact\" placeholder=\"联系人姓名\" />\n        </view>\n        <view class=\"publish__field\">\n          <text class=\"publish__label\">联系电话</text>\n          <input v-model=\"form.contactPhone\" placeholder=\"联系电话\" />\n        </view>\n      </view>\n\n      <view class=\"publish__section\">\n        <view class=\"section-title\">图片上传</view>\n        <view class=\"publish__images\">\n          <image\n            v-for=\"image in form.images\"\n            :key=\"image\"\n            :src=\"image\"\n            mode=\"aspectFill\"\n            class=\"publish__image\"\n          />\n          <view class=\"publish__upload\" @tap=\"chooseImage\">＋</view>\n        </view>\n      </view>\n\n      <view class=\"publish__section\">\n        <view class=\"section-title\">托管与验收</view>\n        <switch :checked=\"form.requireEscrow\" @change=\"onEscrowChange\" />\n        <view class=\"publish__tip\">\n          平台将托管费用，任务完成后双方确认再放款，保障资金安全。\n        </view>\n      </view>\n\n      <button class=\"publish__submit\" type=\"primary\" @tap=\"submit\">\n        {{ isApplyMode ? '确认报名' : '提交发布' }}\n      </button>\n    </view>\n  </scroll-view>\n</template>\n\n<script>\nimport { computed, reactive, ref } from 'vue';\nimport { onLoad } from '@dcloudio/uni-app';\n\nexport default {\n  name: 'PublishPage',\n  setup() {\n    const form = reactive({\n      category: null,\n      description: '',\n      price: null,\n      unit: '次',\n      schedule: '',\n      location: '',\n      contact: '',\n      contactPhone: '',\n      images: [],\n      requireEscrow: true\n    });\n\n    const categories = [\n      { label: '托管', value: 'CARE' },\n      { label: '接送', value: 'SHUTTLE' },\n      { label: '闲置交易', value: 'RESALE' },\n      { label: '户外活动', value: 'OUTDOOR' },\n      { label: '作业辅导', value: 'HOMEWORK' },\n      { label: '兴趣学习', value: 'LEARNING' }\n    ];\n\n    const units = ['次', '小时', '天', '件'];\n    const routeOptions = ref({});\n    const isApplyMode = computed(() => routeOptions.value.mode === 'apply');\n    const jobId = computed(() => routeOptions.value.jobId || '');\n    const publisherId = computed(() => routeOptions.value.publisherId || 'demo-user');\n    const submitting = ref(false);\n\n    const categoryLabel = computed(() =>\n      form.category && form.category.label ? form.category.label : '选择任务类型'\n    );\n\n    const selectCategory = (event) => {\n      const index = event.detail.value;\n      form.category = categories[index];\n    };\n\n    const selectUnit = (event) => {\n      const index = event.detail.value;\n      form.unit = units[index];\n    };\n\n    const chooseImage = () => {\n      uni.chooseImage({\n        count: 4,\n        success: (res) => {\n          const files = res.tempFilePaths || [];\n          form.images = form.images.concat(files).slice(0, 4);\n        }\n      });\n    };\n\n    const onEscrowChange = (event) => {\n      form.requireEscrow = event.detail.value;\n    };\n\n    const validateForm = () => {\n      if (!form.category) return '请选择任务类型';\n      if (!form.description) return '请填写任务描述';\n      if (!form.price) return '请填写预算金额';\n      if (!form.location) return '请输入服务地址';\n      if (!form.contact || !form.contactPhone) return '请填写联系人信息';\n      return '';\n    };\n\n    const submit = () => {\n      if (submitting.value) {\n        return;\n      }\n      submitting.value = true;\n\n      if (isApplyMode.value) {\n        if (!jobId.value) {\n          uni.showToast({ title: '任务信息缺失', icon: 'none' });\n          submitting.value = false;\n          return;\n        }\n        const orderPayload = {\n          jobId: jobId.value,\n          takerId: 'demo-applicant',\n          publisherId: publisherId.value,\n          amount: Number(form.price || 0),\n          escrowed: form.requireEscrow\n        };\n        uni.request({\n          url: 'http://localhost:8080/api/orders',\n          method: 'POST',\n          data: orderPayload,\n          success: () => {\n            uni.showToast({ title: '报名成功', icon: 'success' });\n            setTimeout(() => {\n              uni.switchTab({ url: '/pages/messages/messages' });\n            }, 500);\n          },\n          fail: () => {\n            uni.showToast({ title: '网络异常，请稍后再试', icon: 'none' });\n          },\n          complete: () => {\n            submitting.value = false;\n          }\n        });\n        return;\n      }\n\n      const error = validateForm();\n      if (error) {\n        uni.showToast({ title: error, icon: 'none' });\n        submitting.value = false;\n        return;\n      }\n\n      const jobPayload = {\n        title: `${form.category.label} · ${form.schedule || '灵活时间'}`,\n        description: form.description,\n        category: form.category.value,\n        price: Number(form.price),\n        unit: form.unit,\n        schedule: form.schedule,\n        location: form.location,\n        city: routeOptions.value.city || '',\n        tags: form.category ? [form.category.label] : [],\n        images: form.images,\n        requireEscrow: form.requireEscrow,\n        publisherId: publisherId.value,\n        contactName: form.contact,\n        contactPhone: form.contactPhone\n      };\n\n      uni.request({\n        url: 'http://localhost:8080/api/jobs',\n        method: 'POST',\n        data: jobPayload,\n        success: () => {\n          uni.showToast({ title: '发布成功', icon: 'success' });\n          setTimeout(() => {\n            uni.switchTab({ url: '/pages/home/home' });\n          }, 500);\n        },\n        fail: () => {\n          uni.showToast({ title: '网络异常，已存草稿', icon: 'none' });\n        },\n        complete: () => {\n          submitting.value = false;\n        }\n      });\n    };\n\n    onLoad((options) => {\n      routeOptions.value = options || {};\n    });\n\n    return {\n      form,\n      categories,\n      units,\n      categoryLabel,\n      selectCategory,\n      selectUnit,\n      chooseImage,\n      submit,\n      onEscrowChange,\n      isApplyMode\n    };\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.publish {\n  min-height: 100vh;\n\n  &__section {\n    background: #fff;\n    border-radius: 16rpx;\n    padding: 24rpx;\n    margin-bottom: 24rpx;\n  }\n\n  &__input {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    font-size: 28rpx;\n    padding: 20rpx 24rpx;\n    border: 1px solid #eee;\n    border-radius: 12rpx;\n  }\n\n  &__icon {\n    color: #999;\n  }\n\n  &__textarea {\n    margin-top: 20rpx;\n    min-height: 180rpx;\n    padding: 20rpx;\n    border-radius: 12rpx;\n    background: #f8f9fb;\n    font-size: 28rpx;\n  }\n\n  &__group {\n    display: flex;\n    justify-content: space-between;\n    margin-top: 24rpx;\n    gap: 24rpx;\n\n    &-item {\n      flex: 1;\n      font-size: 28rpx;\n      display: flex;\n      flex-direction: column;\n      gap: 12rpx;\n    }\n  }\n\n  &__field {\n    margin-top: 24rpx;\n    font-size: 28rpx;\n    display: flex;\n    flex-direction: column;\n    gap: 12rpx;\n\n    input {\n      padding: 20rpx 24rpx;\n      border: 1px solid #eee;\n      border-radius: 12rpx;\n    }\n  }\n\n  &__label {\n    font-size: 26rpx;\n    color: #666;\n  }\n\n  &__images {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 16rpx;\n  }\n\n  &__image {\n    width: 200rpx;\n    height: 200rpx;\n    border-radius: 12rpx;\n  }\n\n  &__upload {\n    width: 200rpx;\n    height: 200rpx;\n    border: 1px dashed #ccc;\n    border-radius: 12rpx;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 48rpx;\n    color: #bbb;\n  }\n\n  &__tip {\n    margin-top: 16rpx;\n    font-size: 24rpx;\n    color: #888;\n  }\n\n  &__submit {\n    margin-top: 16rpx;\n    background: linear-gradient(135deg, #1e9fff, #5b8bf7);\n    border: none;\n  }\n}\n</style>\n","import mod from \"-!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./publish.vue?vue&type=style&index=0&id=177a8126&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./publish.vue?vue&type=style&index=0&id=177a8126&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1761280057931\n      var cssReload = require(\"C:/Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}